name: Hardhat local

on:
  push:
    # branches:
    #   - main
  pull_request:

  workflow_dispatch:

env:
  envfile: ${{secrets.ENV}}

jobs:
  test-local:
    runs-on: ubuntu-latest

    steps:
      - uses: actions/checkout@v3

      - uses: pnpm/action-setup@v2
        with:
          version: 8.6.6

      - uses: actions/setup-node@v3
        with:
          cache: "pnpm"
          node-version: "20.9.0"
          check-latest: true

      - name: Write environment
        run: |
          echo $envfile > .env
          sed -i 's/ /\n/g' .env
          source .env

      - name: Test Local
        uses: ambersun1234/hardhat-test-action@v1

      - name: Integration test
        uses: ambersun1234/hardhat-test-action@v1
        with:
          network: sepolia
          private_key: ${{ env.PRIVATE_KEY }}
          rpc_url: ${{ env.RPC_URL }}


      # - name: Test
      #   uses: ambersun1234/hardhat-test-action@v1
      #   with:
      #     network: goerli
      #     private_key: ${{ secrets.PRIVATE_KEY }}
      #     rpc_url: ${{ secrets.RPC_URL }}

